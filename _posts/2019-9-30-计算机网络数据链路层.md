---
layout:     post
title:      计算机网络数据链路层
subtitle:   
date:       2019-9-30
author:     度朝腾
catalog: true
tags:
    - 计算机网络
---

### 一、数据链路层的功能：主要作用就是加强物理层传输原始比特流的功能，将物理层提供的可能出粗的物理连接改造为逻辑上无差错的数据链路，使其对网络层表现为无差错的链路

1. 为网络层提供服务：基本任务是将源机器中来自网络层的数据传输到目标机器的网络层
   - 无确认的无连接服务
   - 有确认的无连接服务
   - 有确认的面向连接服务
   - 有连接就一定有确认
2. 链路管理：数据链路层连接的建立、维持、释放过程称为链路管理
   - 主要用于面向连接的服务
   - 首先确认对方已处于就绪状态，并交换一些必要的信息以对帧序号初始化
   - 建立连接
   - 在传输过程中维持连接
   - 传输完毕释放该连接
3. 帧界定、帧同步、透明传输
   - 帧界定：确定帧的界限
   - 帧同步：接收方能从接收到的二进制比特流区分出帧的起始和终止
   - 不管数据是什么比特组合，都能在链路上传输
4. 流量控制
   - 限制发送方的数据流量，防止其发送速率超过接收方的接受能力
   - 控制的相邻两结点之间数据链路上的流量
5. 差错控制
   - 使发送方确定接收方是否正确收到其发送的数据的方法称为差错控制
   - 位错：帧中某些位产生差错，通常用循环冗余校验发现位错，通过自动重传请求方式来重传出错的帧
   - 帧错：帧的丢失、重复、失序等错误，引入定时器和编号机制，能保证每一帧最终都能且仅有一次正确地交付

### 二、组帧：数据链路层之所以把比特组合成帧为单位传输，是为了出错时只重发出错的帧，而不重发所有数据

1. 字符统计法（脆弱性）（计数字段也算进计数中）
   - 在帧头部使用一个计数字段来标明帧内字符数，可以确定帧结束的位置
   - **最大问题在于**如果计数字段出错，收发双方将失去同步，造成灾难性后果
2. 字符填充的首尾定界符法（复杂性）
   - 使用特定字符来定界一帧的开始与结束
   - 书上那啥DEL STX什么的，就是一个首尾标志，没有转义字符
   - DEL转义字符可以防止特殊字符的误判，并且只是一个字符而不是三个，特殊字符就是我们规定好的那些，不一定只有一个
3. 比特填充的首尾标志法
   - 用0111110来标志一帧的开始与结束
   - 发送方的数据链路层在信息位遇到五个连续的1时，自动在其后面插入一个0
   - 接收方没收到五个连续的1时，自动删除后面紧跟的0，恢复原信息
   - 性能优于字符填充法
4. 违规编码法
   - 利用违规（不使用的编码规则）编码来定界帧的起始和结束
   - 不需要采用任何填充技术，就能实现数据传输的**透明性**
   - 只适合采用冗余编码的特殊编码环境（有不使用的编码规则）

### 三、差错控制（传输中的差错基本都是有噪声引起的）

1. 两种噪声
   - 信道随机热噪声：提高信噪比来减少或避免
   - 外界特定短暂原因所造成的冲击噪声：**产生差错的重要原因**
2. 差错控制
   - 自动重传请求（ARQ）
   - 前向纠错（FEC）
3. 检错编码（哟哟哟，这不是计组嘛）
   - 奇偶校验码（去看计组）
   - 循环冗余码（去看计组）
4. 纠错编码
   - 海明码（去看计组）

### 四、流量控制与可靠传输机制

1. 基本方法是由接收方控制发送方发送数据的速率
2. 停止-等待流量控制基本原理（类似与发送窗口与接受窗口都只有1）
   - 发送方每发送一帧，都要等待接收方的应答信号，之后才发送下一帧
   - 接收方每接受一帧，都要反馈发送方一应答信号，表示可接受下一帧
   - 如果接收方一直不反馈应答信号，那么发送方就必须一直等待
   - 每次只允许发送一帧
   - **传输效率很低**
3. 滑动窗口流量控制基本原理
   - 在任意时刻，发送方都维持一组连续的允许发送的帧的信号，称为**发送窗口**
   - 在任意时刻，接收方都维持一组连续的允许接受的帧的信号，称为**接收窗口**
   - 发送窗口的大小代表还未收到对方确认信息的情况下发送方最多还可以发送多少个数据帧
   - 接受方只有收到的数据帧的序号落入接受窗口内才允许将该数据帧收下，其他的**丢弃**
   - 发送端每接受到一个确认帧，**发送窗口就向前滑动一个帧的位置**，当发送窗口内没有可以发送的帧时，发送方就会停止发送，直到收到接收方发送的**确认帧使窗口移动**，**窗口内有可以发送的帧的时候**，才开始继续发送
   - 接收端收到数据帧后，将窗口向前移动一个位置，并且返回确认帧
4. 可靠传输机制
   - 确认是一种**无数据**的控制帧，这种控制帧使得接收方可以让发送方知道哪些内容被正确接收
   - 为了提高效率，有时候将确认捎带在一个回复帧中，称为**捎带确认**
   - 超时重传是指发送方在发送某个数据帧后就开启一个计时器，在一定时间内如果没有得到发送的数据帧的确认帧，那么就重新发送该数据帧，**直到发送成功为止**
   - 自动重传请求：
     1. 停止-等待
     2. 后退N帧
     3. 选择性重传

### 五、单帧滑动窗口和停止-等待协议

1. 停止-等待协议可能出现的错误：
   - 数据帧丢失
   - 到达目的站的帧可以已经损坏，接收站检测出错误后，只是单纯地将该帧丢弃
   - 数据帧正确但是确认帧被破坏
   - 有详细规则描述，在书上有

### 六、多帧滑动窗口和后退N帧协议

1. 发送方无需在收到上一个帧的ACK后才能开始发送下一帧，可以连续发送帧
2. 当接收方检测出失序的信息帧后，要求发送方重发**最后一个能正确接收**的信息帧之后 的**所有未被确认的帧**
3. 当发送方发送N个帧后，若发现**该N个帧的前一个帧**在计时器超时后仍未返回其确认信息，则该帧被判为出错或丢失，此时发送方不得不重传**该出错帧及随后的N个帧**
4. 接收方只允许按顺序接受帧





